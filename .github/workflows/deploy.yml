name: Test Deploy to app (gh-pages)

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  test-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout source (archive)
        uses: actions/checkout@v4

      # 빌드 대신 간단한 정적 파일 생성
      - name: Create simple site
        run: |
          mkdir -p dist
          cat > dist/index.html << 'EOF'
          <!doctype html>
          <html lang="en">
          <head><meta charset="utf-8"><title>Deployed!</title></head>
          <body>
            <h1>It works 🎉</h1>
            <p>Deployed from <b>archive</b> to <b>app</b>.</p>
          </body>
          </html>
          EOF

      - name: Deploy to app repo gh-pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          token: ${{ secrets.GH_PAT }}   # 시크릿 이름 'GH_PAT' 확인!
          branch: gh-pages
          folder: dist
          repository-name: runarchive-lab/app  # 본인 계정/레포명 확인
          clean: true
          single-commit: true
